
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Using everest applications &mdash; everest demo 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/bootstrap.js"></script>
    <link rel="top" title="everest demo 0.1 documentation" href="index.html" />
    <link rel="next" title="Glossary of Terms" href="glossary.html" />
    <link rel="prev" title="Building everest applications" href="building.html" />
<script type="text/javascript">
(function () {
  /**
   * Patch TOC list.
   *
   * Will mutate the underlying span to have a correct ul for nav.
   *
   * @param $span: Span containing nested UL's to mutate.
   * @param minLevel: Starting level for nested lists. (1: global, 2: local).
   */
  var patchToc = function ($ul, minLevel) {
    var findA;

    // Find all a "internal" tags, traversing recursively.
    findA = function ($elem, level) {
      var level = level || 0,
        $items = $elem.find("> li > a.internal, > ul, > li > ul");

      // Iterate everything in order.
      $items.each(function (index, item) {
        var $item = $(item),
          tag = item.tagName.toLowerCase(),
          pad = 15 + ((level - minLevel) * 10);

        if (tag === 'a' && level >= minLevel) {
          // Add to existing padding.
          $item.css('padding-left', pad + "px");
          console.log(level, $item, 'padding-left', pad + "px");
        } else if (tag === 'ul') {
          // Recurse.
          findA($item, level + 1);
        }
      });
    };

    console.log("HERE");
    findA($ul);
  };

  $(document).ready(function () {
    // Add styling, structure to TOC's.
    $(".dropdown-menu").each(function () {
      $(this).find("ul").each(function (index, item){
        var $item = $(item);
        $item.addClass('unstyled');
      });
      $(this).find("li").each(function () {
        $(this).parent().append(this);
      });
    });

    // Patch in level.
    patchToc($("ul.globaltoc"), 2);
    patchToc($("ul.localtoc"), 2);

    // Enable dropdown.
    $('.dropdown-toggle').dropdown();
  });
}());
</script>

  </head>
  <body>
  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container-fluid">
        <a class="brand" href="index.html">everest demo</a>
        <span class="navbar-text pull-left"><b>0.1</b></span>
          <ul class="nav">
            <li class="divider-vertical"></li>
            
              <li class="dropdown">
  <a href="index.html" class="dropdown-toggle" data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="building.html">Building <tt class="docutils literal"><span class="pre">everest</span></tt> applications</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Using <tt class="docutils literal"><span class="pre">everest</span></tt> applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary of Terms</a></li>
</ul>
</ul>
</li>
              <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Using <tt class="docutils literal"><span class="pre">everest</span></tt> applications</a><ul>
<li><a class="reference internal" href="#querying-with-get">Querying with GET</a></li>
<li><a class="reference internal" href="#customizing-representations">Customizing representations</a></li>
<li><a class="reference internal" href="#customizing-resources">Customizing resources</a></li>
<li><a class="reference internal" href="#customizing-views">Customizing views</a></li>
</ul>
</li>
</ul>
</ul>
  <!--<span class="localtoc"><ul>
<li><a class="reference internal" href="#">Using <tt class="docutils literal"><span class="pre">everest</span></tt> applications</a><ul>
<li><a class="reference internal" href="#querying-with-get">Querying with GET</a></li>
<li><a class="reference internal" href="#customizing-representations">Customizing representations</a></li>
<li><a class="reference internal" href="#customizing-resources">Customizing resources</a></li>
<li><a class="reference internal" href="#customizing-views">Customizing views</a></li>
</ul>
</li>
</ul>
</span>-->
</li>
            
            
              
  <li><a href="building.html"
         title="previous chapter">&laquo; Building <tt class="docutils literal docutils literal docutils literal"><span class="pre">everest</span></tt> applications</a></li>
  <li><a href="glossary.html"
         title="next chapter">Glossary of Terms &raquo;</a></li>
            
            
              
  <li><a href="_sources/using.txt"
         rel="nofollow">Source</a></li>
            
          </ul>
          
            
<form class="navbar-search pull-right" style="margin-bottom:-3px;" action="search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
          </ul>
        </div>
      </div>
    </div>
  </div>

<div class="container">
   
  <div class="section" id="using-everest-applications">
<h1>Using <tt class="xref py py-mod docutils literal"><span class="pre">everest</span></tt> applications<a class="headerlink" href="#using-everest-applications" title="Permalink to this headline">¶</a></h1>
<div class="section" id="querying-with-get">
<h2>Querying with GET<a class="headerlink" href="#querying-with-get" title="Permalink to this headline">¶</a></h2>
<div class="sidebar">
<p class="first sidebar-title">Collection Query Language (CQL)</p>
<p><tt class="xref py py-mod docutils literal"><span class="pre">everest</span></tt> supports a custom Collection Query Language (CQL) for
querying collection resources.</p>
<p>CQL query expressions are composed of one or more query criteria separated
by the tilde (&#8220;~&#8221;) character. Each criterion consists of three parts
separated by a colon (&#8221;:&#8221;) character :</p>
<ol class="arabic simple">
<li>resource attribute name
The name of the resource attribute to query. You can specify dotted
names to query nested resources.</li>
<li>operator
The operator to apply.</li>
<li>value
The value to query for. It is possible to supply multiple values
in a comma separated list, which will be interpreted as a Boolean &#8220;OR&#8221;
operation on all given values.</li>
</ol>
<p>Supported query criterion value types are:</p>
<dl class="last docutils">
<dt>String</dt>
<dd>Arbitrary string enclosed in double quotes.</dd>
<dt>Number</dt>
<dd>Integer or floating point, scientific notation allowed.</dd>
<dt>Boolean</dt>
<dd>Case insensitive string <strong>true</strong> or <strong>false</strong>.</dd>
<dt>Date/Time</dt>
<dd>ISO 8601 encoded string enclosed in double quotes.</dd>
<dt>Resource</dt>
<dd>URL referencing a resource.</dd>
</dl>
</div>
<p>One of the main features of the collection resources in <tt class="xref py py-mod docutils literal"><span class="pre">everest</span></tt> are their
advanced querying, batching, and ordering capabilities.</p>
<p>Query strings have to be submitted as expressions
&#8220;Collection Query Language&#8221;</p>
<p>A GET request to a collection resource with a query string such as</p>
<p><a class="reference external" href="http://localhost:6543/customers?q=first-name:startswith">http://localhost:6543/customers?q=first-name:startswith</a>:&#8221;J&#8221;?order=last-name:asc?size=100</p>
<p>is processed by <tt class="xref py py-mod docutils literal"><span class="pre">everest</span></tt> as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>The context and its associated view are identified just as in any vanilla
<tt class="xref py py-mod docutils literal"><span class="pre">Pyramid</span></tt> application. In the example, this would be the <tt class="docutils literal"><span class="pre">customers</span></tt>
collection resource at the root of the object tree (the &#8220;root collection&#8221;)
and the <tt class="xref py py-class docutils literal"><span class="pre">everest.views.getcollection.GetCollectionView</span></tt>;</li>
<li>The view parses the query string submitted by the client (in the example,
the <tt class="docutils literal"><span class="pre">q=first-name:equal-to:John</span></tt> part of the URL) into a resource
filter specification and applies it to the context collection resource.
This triggers a translation of the resource filter specification into
an entity filter specification which is then applied to the underlying
aggregate. This separation of resource and entity level attributes makes
it not only possible to expose entity attributes under a different name
at the level of the resource, but also to expose attributes from nested
entities;</li>
<li>The view parses and applies the order string (<tt class="docutils literal"><span class="pre">order=last-name:asc</span></tt>)
in the same fashion as the query string;</li>
</ol>
<p>4. The view parses the size string (<tt class="docutils literal"><span class="pre">size=100</span></tt>)
4. The view iterates over the context collection resourc and wraps the</p>
<blockquote>
<div>filtered, ordered, and batched member resources into a new result
collection resource;</div></blockquote>
<ol class="arabic simple" start="5">
<li>The resulting collection resource is passed to</li>
</ol>
</div></blockquote>
<p>As an example, querying a collection resource &#8220;&#8221;</p>
<p>If a query contains multiple criteria with different resource attribute names,
the criteria are interpreted as a Boolean &#8220;AND&#8221; operation.</p>
<p>The following table shows the available operators and data types in CQL:</p>
<table border="1" class="docutils">
<colgroup>
<col width="42%" />
<col width="12%" />
<col width="9%" />
<col width="10%" />
<col width="15%" />
<col width="12%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operator</th>
<th class="head" colspan="5">Data Type</th>
</tr>
<tr class="row-even"><th class="head">Name</th>
<th class="head">String</th>
<th class="head">Number</th>
<th class="head">Boolean</th>
<th class="head">Date/Time</th>
<th class="head">Resource</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">starts-with</span></tt></td>
<td>x</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">not-starts-with</span></tt></td>
<td>x</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">ends-with</span></tt></td>
<td>x</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">not-ends-with</span></tt></td>
<td>x</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">contains</span></tt></td>
<td>x</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">not-contains</span></tt></td>
<td>x</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">contained</span></tt></td>
<td>x</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">not-contained</span></tt></td>
<td>x</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">equal-to</span></tt></td>
<td>x</td>
<td>x</td>
<td>x</td>
<td>x</td>
<td>x</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">not-equal-to</span></tt></td>
<td>x</td>
<td>x</td>
<td>x</td>
<td>x</td>
<td>x</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">less-than</span></tt></td>
<td>&nbsp;</td>
<td>x</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">less-than-or-equal-to</span></tt></td>
<td>&nbsp;</td>
<td>x</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">greater-than</span></tt></td>
<td>&nbsp;</td>
<td>x</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">greater-than-or-equal-to</span></tt></td>
<td>&nbsp;</td>
<td>x</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">in-range</span></tt></td>
<td>&nbsp;</td>
<td>x</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<p>All attributes that are used to compose a query expression need to be mapped
column properties in the ORM. Aliases are supported, CompositeProperties are
not. All queried entities must have an &#8220;id&#8221; attribute.</p>
<p>It is by design that the power of CQL to express complex queries is far behind
that of SQL.</p>
</div>
<div class="section" id="customizing-representations">
<h2>Customizing representations<a class="headerlink" href="#customizing-representations" title="Permalink to this headline">¶</a></h2>
<p>The default behavior of the <tt class="xref py py-mod docutils literal"><span class="pre">everest</span></tt> representers is to</p>
<blockquote>
<div><ul class="simple">
<li>Represent all terminal attributes explicitly;</li>
<li>Represent nested member resources as links; and</li>
<li>Ignore nested collection resources.</li>
</ul>
</div></blockquote>
<p>Nested collections are ignored by default because generating a URL for a
collection may require iterating over all its members which is potentially
a very time consuming operation.</p>
<p>To change these defaults for a given resource attribute, we set the appropriate
<tt class="docutils literal"><span class="pre">representer</span></tt>, <tt class="docutils literal"><span class="pre">attribute</span></tt> and <tt class="docutils literal"><span class="pre">option</span></tt> tags inside a <tt class="docutils literal"><span class="pre">resource</span></tt>
declaration. For example, to include the nested <tt class="docutils literal"><span class="pre">projects</span></tt> collection in
<tt class="docutils literal"><span class="pre">XML</span></tt> representations of <tt class="docutils literal"><span class="pre">customer</span></tt> members we would include the
following declaration in the <tt class="docutils literal"><span class="pre">ZCML</span></tt> configuration file:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;representer</span>
   <span class="na">kind=</span><span class="s">&quot;member&quot;</span>
   <span class="na">content_type=</span><span class="s">&quot;everest.mime.XmlMime&quot;</span>
<span class="nt">&gt;</span>
   <span class="nt">&lt;attribute</span> <span class="na">name=</span><span class="s">&quot;projects&quot;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;option</span>
           <span class="na">name=</span><span class="s">&quot;ignore&quot;</span>
           <span class="na">value=</span><span class="s">&quot;false&quot;</span> <span class="nt">/&gt;</span>
       <span class="nt">&lt;option</span>
           <span class="na">name=</span><span class="s">&quot;write_as_link&quot;</span>
           <span class="na">value=</span><span class="s">&quot;false&quot;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;/attribute&gt;</span>
<span class="nt">&lt;/representer&gt;</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">ignore</span></tt> option is a shorthand for setting both the <tt class="docutils literal"><span class="pre">ignore_on_read</span></tt>
and the <tt class="docutils literal"><span class="pre">ignore_on_write</span></tt> option which set the ignore behavior selectively
when a representation is parsed (<tt class="docutils literal"><span class="pre">ignore_on_read</span></tt>) or generated
(<tt class="docutils literal"><span class="pre">ignore_on_write</span></tt>). The <tt class="docutils literal"><span class="pre">write_as_link</span></tt> option ensures that the nested
resource is represented as a (URL) link rather than as an explicit
recursive representation of all its attributes.</p>
</div>
<div class="section" id="customizing-resources">
<h2>Customizing resources<a class="headerlink" href="#customizing-resources" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="customizing-views">
<h2>Customizing views<a class="headerlink" href="#customizing-views" title="Permalink to this headline">¶</a></h2>
<p>Very l, the standard <tt class="xref py py-mod docutils literal"><span class="pre">everest</span></tt> views will
not</p>
</div>
</div>


</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right"><a href="#">Back to top</a></p>
    <p>
        &copy; Copyright Copyright (c) 2011-2012 F. Oliver Gathmann, Cenix BioScience, Dresden, Germany .<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>